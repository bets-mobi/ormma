<script type="text/javascript">
   var adInitialized = false;
   window.onload = function ()
   {
      // we need to wait until the page has loaded to make sure that all of the
	  // ORMMA code is setup
	  // once it is, let's register for the "ready" event
      window.Ormma.addEventListener( "ready",       ORMMAReadyEventHandler );
      window.Ormma.addEventListener( "stateChange", StateChangedEventHandler );
   }
   
   
   function ExpandAd()
   {
      window.Ormma.expand( null,                            // use the current starting position
	                       { height : 460 }, // expand the height to 460px
						   "http://www.toyota.com" );       // the html to show
   }


   function HeadingChangedEventHandler( headingChangeEvent )
   {
      var h = document.getElementById( "heading" );
	  h.innerHTML = headingChangeEvent.data;
   }
   
   
   function KeyboardChangedEventHandler( keyboardChangeEvent )
   {
      if ( keyboardChangeEvent.open )
	  {
	     // do something when the keyboard opens
	  }
	  else
	  {
	     // do something when the keyboard closes
	  }
   }


   function LocationChangedEventHandler( locationEvent )
   {
      var lattitude = document.getElementById( "lattitude" );
      var longitude = document.getElementById( "longitude" );
      var horizontalAccuracy = document.getElementById( "accuracy" );
	  lattitude.innerHTML = locationEvent.data.lat;
	  longitude.innerHTML = locationEvent.data.lon;
	  accuracy.innerHTML = locationEvent.data.acc;
   }


   function OrientationChangedEventHandler( orientationChangeEvent )
   {
      var orientationSpan = document.getElementById( "orientation" );
	  orientationSpan.innerHTML = orientationChangeEvent.data;
   }

   
   function ORMMAReadyEventHandler()
   {
      // only initialize things one time
      if ( adInitialized ) {
	     return;
	  }
	  adInitialized = true;
	  
      // the ORMMA engine is ready to deal with us
	  // add some event listeners
      window.Ormma.addEventListener( "headingChange",     HeadingChangedEventHandler );
      window.Ormma.addEventListener( "keyboardChange",    KeyboardChangedEventHandler );
      //window.Ormma.addEventListener( "locationChange",    LocationChangedEventHandler );
      window.Ormma.addEventListener( "orientationChange", OrientationChangedEventHandler );
      //window.Ormma.addEventListener( "tiltChange",        TiltChangedEventHandler );
      //window.Ormma.addEventListener( "rotationChange",    RotationChangedEventHandler );
      window.Ormma.addEventListener( "screenSizeChange",  ScreenSizeChangedEventHandler );
      window.Ormma.addEventListener( "sizeChange",        SizeChangedEventHandler );

      // tell it to show the ad
	  window.Ormma.show();
   }
   
   
   function ResizeAd()
   {
      // grow the screen
      window.Ormma.resize( 320, 250 );	  
	  return false;
   }
   
   
   function RestoreToDefault()
   {
	  window.Ormma.close();
	  return false;
   }


   function RotationChangedEventHandler( rotationEvent )
   {
      var x = document.getElementById( "gyroX" );
      var y = document.getElementById( "gyroY" );
      var z = document.getElementById( "gyroZ" );
	  x.innerHTML = rotationEvent.data.x;
	  y.innerHTML = rotationEvent.data.y;
	  z.innerHTML = rotationEvent.data.z;
   }


   function ScreenSizeChangedEventHandler( screenSizeChangeEvent )
   {
      // size of screen has changed
      var sz = document.getElementById( "screen" );
	  sz.innerHTML = screenSizeChangeEvent.data.width + " x " + screenSizeChangeEvent.data.height;
   }


   function SizeChangedEventHandler( sizeChangeEvent )
   {
      // size of ad has changed
	  //alert( "The ad has changed sizes!" );
      var sz = document.getElementById( "size" );
	  sz.innerHTML = sizeChangeEvent.data.width + " x " + sizeChangeEvent.data.height;
   }

   
   function StateChangedEventHandler( stateChangedEvent )
   {
      // show the correct content when the state changes
      var defaultDiv = document.getElementById( "default" );
      var expandedDiv = document.getElementById( "expanded" );
	  if ( stateChangedEvent.data == "default" )
	  {
	     defaultDiv.style.visibility = "visible";
	     expandedDiv.style.visibility = "hidden";
	  }
	  else if ( stateChangedEvent.data == "expanded" )
	  {
	     defaultDiv.style.visibility = "hidden";
	     expandedDiv.style.visibility = "visible";
	  }
      var stateSpan = document.getElementById( "currentState" );
	  stateSpan.innerHTML = stateChangedEvent.data;
   }


   function TiltChangedEventHandler( tiltEvent )
   {
      var x = document.getElementById( "accX" );
      var y = document.getElementById( "accY" );
      var z = document.getElementById( "accZ" );
	  x.innerHTML = tiltEvent.data.x;
	  y.innerHTML = tiltEvent.data.y;
	  z.innerHTML = tiltEvent.data.z;
   }
   
</script>

<div id="default" style="visibility=visible;">
   <a href="javascript:window.ormma.hide();">Hide</a>
   &nbsp;&nbsp;
   <a href="javascript:ResizeAd();">Resize</a>
   &nbsp;&nbsp;
   <a href="javascript:ExpandAd();">Expand</a>
</div>

<div id="expanded" style="visibility=hidden;">
   <a href="javascript:RestoreToDefault();">Close</a><br>
   Screen: <span id="screen"></span><br>
   Orientation: <span id="orientation"></span><br>
   Ad Size: <span id="size"></span> State: <span id="currentState"></span><br>
   Acc: X: <span id="accX"></span>, Y: <span id="accY"></span>, Z: <span id="accZ"></span><br>
   Gyro: X: <span id="gyroX"></span>, Y: <span id="gyroY"></span>, Z: <span id="gyroZ"></span><br>
   Heading: <span id="heading"></span><br>
   Latitude: <span id="lattitude"></span><br>
   Longitude: <span id="longitude"></span><br>
   Accuracy:<span id="accuracy"></span><br>
</div>